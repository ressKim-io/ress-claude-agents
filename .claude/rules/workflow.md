# Workflow Rules

코드 작업 시 반드시 따라야 할 작업 순서 규칙.
이 규칙은 모든 코드 수정, 기능 추가, 버그 수정 작업에 적용된다.

---

## 작업 순서 (MANDATORY)

### 1. EXPLORE — 관련 파일 읽기 (변경 없음)

- 수정할 파일과 관련 파일을 먼저 읽는다.
- 기존 패턴, 컨벤션, 아키텍처를 파악한다.
- 큰 파일은 `wc -l`로 크기 확인 후 필요한 부분만 읽는다.
- 같은 파일을 2회 이상 읽지 않는다.

### 2. PLAN — 구현 계획 수립

- 변경할 파일 목록을 명확히 정리한다.
- 영향 범위(side effect)를 분석한다.
- multi-file 변경 시 반드시 Plan Mode를 사용한다.
- EXPLORE 없이 PLAN 단계로 건너뛰지 않는다.

### 3. IMPLEMENT — 코딩

- 계획에 따라 구현한다.
- 기존 패턴에 맞춰 작성한다 (스타일 일관성 유지).
- 최소한의 변경으로 목적을 달성한다.
- 한 번에 최대 10개 파일까지만 변경한다.

### 4. VERIFY — 검증

- 테스트를 실행하고 통과 여부를 확인한다.
- lint / format 체크를 수행한다.
- 변경 사항을 전체적으로 리뷰한다 (`git diff`).

### 5. COMMIT — 커밋

- Conventional Commits 형식을 사용한다.
  - 예: `feat: add payment retry logic`
  - 예: `fix: resolve null pointer in UserService`
- 의미 있는 커밋 메시지를 작성한다 (무엇을, 왜 변경했는지).
- 테스트가 통과된 상태에서만 커밋한다.

---

## 절대 금지 사항

| 금지 행위 | 이유 |
|---|---|
| multi-file 변경 시 EXPLORE/PLAN 생략 | 예상치 못한 side effect 방지 |
| 읽지 않은 파일 수정 | 기존 코드 파악 없이 변경하면 컨벤션 위반 발생 |
| 테스트 통과 전 커밋 | broken commit이 CI를 오염시킴 |
| 한 번에 10개 초과 파일 변경 | 리뷰 불가능한 커밋 방지 |

---

## 디버깅 순서

```
1. 에러 재현 확인
   - 동일한 조건에서 에러가 재현되는지 검증한다.

2. 원인 파악
   - 로그, 스택트레이스를 분석한다.
   - 관련 파일과 코드 경로를 추적한다.

3. 근본 원인 확인 (Root Cause)
   - 증상(symptom)이 아닌 원인(cause)을 찾는다.
   - 임시방편 수정을 피한다.

4. 수정 후 테스트로 검증
   - 수정 후 에러가 사라졌는지 확인한다.
   - 회귀(regression) 발생 여부도 점검한다.
```

---

## Context 효율화

- **병렬 실행**: 독립적인 읽기 작업은 동시에 실행한다.
- **크기 확인 우선**: 큰 파일은 전체 읽기 전 `wc -l` 또는 line offset 활용.
- **중복 읽기 금지**: 이미 읽은 파일은 다시 읽지 않는다 (메모리에 유지).
- **범위 최소화**: 변경과 무관한 코드는 읽지 않는다.
